

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="WZN">
  <meta name="keywords" content="">
  
    <meta name="description" content="å‚è€ƒï¼šhttps:&#x2F;&#x2F;zhuanlan.zhihu.com&#x2F;p&#x2F;601743047https:&#x2F;&#x2F;tianchi.aliyun.com&#x2F;notebook&#x2F;844878 è¯æ±‡ç‰¹å¾ï¼ˆfeatureï¼‰å°±æ˜¯èƒ½è¢«æœºå™¨æ‹¿æ¥è®¡ç®—ã€æ¯”è¾ƒã€åšå†³ç­–çš„â€œé‡åŒ–äº‹å®â€ã€‚è¿‘ä¼¼æœ€è¿‘é‚»æœç´¢ï¼ˆANNï¼‰å®ƒå¹¶ä¸è¿½æ±‚æ‰¾åˆ°ä¸ç”¨æˆ·å‘é‡è·ç¦»æœ€è¿‘çš„ç²¾ç¡®ç‰©å“å‘é‡ï¼Œè€Œæ˜¯åœ¨å¯æ¥å—çš„è¯¯å·®èŒƒå›´å†…ï¼Œå¿«é€Ÿæ‰¾å‡ºä¸ç”¨æˆ·å‘é‡è·ç¦»è¾ƒè¿‘çš„ä¸€äº›ç‰©å“å‘é‡åœ¨æ•°æ®åº“ä¸ºä»€ä¹ˆåŠ ä¸Š">
<meta property="og:type" content="article">
<meta property="og:title" content="åŒå¡”æ¨¡å‹">
<meta property="og:url" content="http://example.com/2025/10/24/%E5%8F%8C%E5%A1%94%E6%A8%A1%E5%9E%8B/index.html">
<meta property="og:site_name" content="å“’å¦®å“’å¦®">
<meta property="og:description" content="å‚è€ƒï¼šhttps:&#x2F;&#x2F;zhuanlan.zhihu.com&#x2F;p&#x2F;601743047https:&#x2F;&#x2F;tianchi.aliyun.com&#x2F;notebook&#x2F;844878 è¯æ±‡ç‰¹å¾ï¼ˆfeatureï¼‰å°±æ˜¯èƒ½è¢«æœºå™¨æ‹¿æ¥è®¡ç®—ã€æ¯”è¾ƒã€åšå†³ç­–çš„â€œé‡åŒ–äº‹å®â€ã€‚è¿‘ä¼¼æœ€è¿‘é‚»æœç´¢ï¼ˆANNï¼‰å®ƒå¹¶ä¸è¿½æ±‚æ‰¾åˆ°ä¸ç”¨æˆ·å‘é‡è·ç¦»æœ€è¿‘çš„ç²¾ç¡®ç‰©å“å‘é‡ï¼Œè€Œæ˜¯åœ¨å¯æ¥å—çš„è¯¯å·®èŒƒå›´å†…ï¼Œå¿«é€Ÿæ‰¾å‡ºä¸ç”¨æˆ·å‘é‡è·ç¦»è¾ƒè¿‘çš„ä¸€äº›ç‰©å“å‘é‡åœ¨æ•°æ®åº“ä¸ºä»€ä¹ˆåŠ ä¸Š">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-10-24T01:11:32.000Z">
<meta property="article:modified_time" content="2025-10-28T05:51:28.219Z">
<meta property="article:author" content="WZN">
<meta property="article:tag" content="æ¨èç®—æ³•">
<meta property="article:tag" content="æ·±åº¦å­¦ä¹ ">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>åŒå¡”æ¨¡å‹ - å“’å¦®å“’å¦®</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>é¦–é¡µ</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>å½’æ¡£</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>åˆ†ç±»</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>æ ‡ç­¾</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>å…³äº</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="åŒå¡”æ¨¡å‹"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-10-24 09:11" pubdate>
          2025å¹´10æœˆ24æ—¥ ä¸Šåˆ
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          3.6k å­—
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          31 åˆ†é’Ÿ
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">åŒå¡”æ¨¡å‹</h1>
            
            
              <div class="markdown-body">
                
                <p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/601743047">https://zhuanlan.zhihu.com/p/601743047</a><br><a target="_blank" rel="noopener" href="https://tianchi.aliyun.com/notebook/844878">https://tianchi.aliyun.com/notebook/844878</a></p>
<h2 id="è¯æ±‡"><a href="#è¯æ±‡" class="headerlink" title="è¯æ±‡"></a>è¯æ±‡</h2><h3 id="ç‰¹å¾ï¼ˆfeatureï¼‰å°±æ˜¯èƒ½è¢«æœºå™¨æ‹¿æ¥è®¡ç®—ã€æ¯”è¾ƒã€åšå†³ç­–çš„â€œé‡åŒ–äº‹å®â€ã€‚"><a href="#ç‰¹å¾ï¼ˆfeatureï¼‰å°±æ˜¯èƒ½è¢«æœºå™¨æ‹¿æ¥è®¡ç®—ã€æ¯”è¾ƒã€åšå†³ç­–çš„â€œé‡åŒ–äº‹å®â€ã€‚" class="headerlink" title="ç‰¹å¾ï¼ˆfeatureï¼‰å°±æ˜¯èƒ½è¢«æœºå™¨æ‹¿æ¥è®¡ç®—ã€æ¯”è¾ƒã€åšå†³ç­–çš„â€œé‡åŒ–äº‹å®â€ã€‚"></a>ç‰¹å¾ï¼ˆfeatureï¼‰<code>å°±æ˜¯èƒ½è¢«æœºå™¨æ‹¿æ¥è®¡ç®—ã€æ¯”è¾ƒã€åšå†³ç­–çš„â€œé‡åŒ–äº‹å®â€ã€‚</code></h3><h3 id="è¿‘ä¼¼æœ€è¿‘é‚»æœç´¢ï¼ˆANNï¼‰å®ƒå¹¶ä¸è¿½æ±‚æ‰¾åˆ°ä¸ç”¨æˆ·å‘é‡è·ç¦»æœ€è¿‘çš„ç²¾ç¡®ç‰©å“å‘é‡ï¼Œè€Œæ˜¯åœ¨å¯æ¥å—çš„è¯¯å·®èŒƒå›´å†…ï¼Œå¿«é€Ÿæ‰¾å‡ºä¸ç”¨æˆ·å‘é‡è·ç¦»è¾ƒè¿‘çš„ä¸€äº›ç‰©å“å‘é‡"><a href="#è¿‘ä¼¼æœ€è¿‘é‚»æœç´¢ï¼ˆANNï¼‰å®ƒå¹¶ä¸è¿½æ±‚æ‰¾åˆ°ä¸ç”¨æˆ·å‘é‡è·ç¦»æœ€è¿‘çš„ç²¾ç¡®ç‰©å“å‘é‡ï¼Œè€Œæ˜¯åœ¨å¯æ¥å—çš„è¯¯å·®èŒƒå›´å†…ï¼Œå¿«é€Ÿæ‰¾å‡ºä¸ç”¨æˆ·å‘é‡è·ç¦»è¾ƒè¿‘çš„ä¸€äº›ç‰©å“å‘é‡" class="headerlink" title="è¿‘ä¼¼æœ€è¿‘é‚»æœç´¢ï¼ˆANNï¼‰å®ƒå¹¶ä¸è¿½æ±‚æ‰¾åˆ°ä¸ç”¨æˆ·å‘é‡è·ç¦»æœ€è¿‘çš„ç²¾ç¡®ç‰©å“å‘é‡ï¼Œè€Œæ˜¯åœ¨å¯æ¥å—çš„è¯¯å·®èŒƒå›´å†…ï¼Œå¿«é€Ÿæ‰¾å‡ºä¸ç”¨æˆ·å‘é‡è·ç¦»è¾ƒè¿‘çš„ä¸€äº›ç‰©å“å‘é‡"></a>è¿‘ä¼¼æœ€è¿‘é‚»æœç´¢ï¼ˆANNï¼‰<code>å®ƒå¹¶ä¸è¿½æ±‚æ‰¾åˆ°ä¸ç”¨æˆ·å‘é‡è·ç¦»æœ€è¿‘çš„ç²¾ç¡®ç‰©å“å‘é‡ï¼Œè€Œæ˜¯åœ¨å¯æ¥å—çš„è¯¯å·®èŒƒå›´å†…ï¼Œå¿«é€Ÿæ‰¾å‡ºä¸ç”¨æˆ·å‘é‡è·ç¦»è¾ƒè¿‘çš„ä¸€äº›ç‰©å“å‘é‡</code></h3><h3 id="åœ¨æ•°æ®åº“ä¸ºä»€ä¹ˆåŠ ä¸Šç´¢å¼•å¯ä»¥åŠ å¿«æŸ¥è¯¢ï¼Ÿ"><a href="#åœ¨æ•°æ®åº“ä¸ºä»€ä¹ˆåŠ ä¸Šç´¢å¼•å¯ä»¥åŠ å¿«æŸ¥è¯¢ï¼Ÿ" class="headerlink" title="åœ¨æ•°æ®åº“ä¸ºä»€ä¹ˆåŠ ä¸Šç´¢å¼•å¯ä»¥åŠ å¿«æŸ¥è¯¢ï¼Ÿ"></a>åœ¨æ•°æ®åº“ä¸ºä»€ä¹ˆåŠ ä¸Šç´¢å¼•å¯ä»¥åŠ å¿«æŸ¥è¯¢ï¼Ÿ</h3><p><code>æ²¡æœ‰ç´¢å¼• = ä½ æŸ¥â€œå–µâ€å­—åªèƒ½ä»ç¬¬ä¸€é¡µé€é¡µç¿»åˆ°æœ€åä¸€é¡µï¼Œæœ€åæƒ…å†µç¿»å®Œå…¨ä¹¦ã€‚</code><br><code>æœ‰ç´¢å¼• = å…ˆç¿»å‰é¢çš„éƒ¨é¦–æ£€å­—è¡¨ï¼Œç¬é—´å®šä½åˆ°â€œå–µâ€åœ¨ç¬¬ 863 é¡µï¼Œç›´æ¥è·³è¿‡å»ã€‚</code><br><strong>ç´¢å¼•æŠŠâ€œæŒ‰å€¼æŸ¥æ‰¾â€çš„å…¨è¡¨æ‰«æï¼ˆO(n)ï¼‰å˜æˆæ ‘å½¢äºŒåˆ†æœç´¢ï¼ˆO(log n) ç”šè‡³ O(1)ï¼‰ï¼Œæ‰€ä»¥å¿«ã€‚</strong></p>
<p>æ•°æ®è¡Œå­˜åœ¨èšç°‡ç´¢å¼•ï¼ˆä¸»é”®ï¼‰çš„å¶å­é¡µé‡Œï¼Œç›¸å½“äºå­—å…¸æ­£æ–‡ã€‚<br>ä½ ç»™ name å­—æ®µå†åŠ äºŒçº§ç´¢å¼•ï¼Œæ•°æ®åº“ä¼šé¢å¤–å»ºä¸€æ£µ B+ æ ‘ï¼Œå¶å­åªå­˜ nameâ†’ä¸»é”® çš„æ˜ å°„ã€‚<br>æŸ¥è¯¢ WHERE name&#x3D;â€™Aliceâ€™ æ—¶ï¼š<br>èµ° name ç´¢å¼•æ ‘ï¼Œ** log n æ­¥** æ‰¾åˆ°å¯¹åº”ä¸»é”®ï¼›<br>ç”¨ä¸»é”®å›è¡¨ï¼ˆä¸€æ¬¡éšæœº IOï¼‰æ‹¿æ•´è¡Œï¼›<br>æ•´ä½“è€—æ—¶ â‰ˆ æ ‘é«˜ 3-4 æ¬¡ç£ç›˜é¡µè¯»å–ï¼Œè€Œä¸æ˜¯å‡ åä¸‡æ¬¡ã€‚</p>
<h3 id="å†·å¯åŠ¨ï¼šç³»ç»Ÿâ€œä»é›¶å¼€å§‹â€ï¼Œæ²¡æœ‰å†å²æ•°æ®ï¼Œæ¨¡å‹åªèƒ½é çŒœã€‚"><a href="#å†·å¯åŠ¨ï¼šç³»ç»Ÿâ€œä»é›¶å¼€å§‹â€ï¼Œæ²¡æœ‰å†å²æ•°æ®ï¼Œæ¨¡å‹åªèƒ½é çŒœã€‚" class="headerlink" title="å†·å¯åŠ¨ï¼šç³»ç»Ÿâ€œä»é›¶å¼€å§‹â€ï¼Œæ²¡æœ‰å†å²æ•°æ®ï¼Œæ¨¡å‹åªèƒ½é çŒœã€‚"></a>å†·å¯åŠ¨ï¼š<code>ç³»ç»Ÿâ€œä»é›¶å¼€å§‹â€ï¼Œæ²¡æœ‰å†å²æ•°æ®ï¼Œæ¨¡å‹åªèƒ½é çŒœã€‚</code></h3><h3 id="ç‰¹å¾äº¤å‰"><a href="#ç‰¹å¾äº¤å‰" class="headerlink" title="ç‰¹å¾äº¤å‰"></a>ç‰¹å¾äº¤å‰</h3><p><code>ç‰¹å¾äº¤å‰å°±æ˜¯æŠŠä¸¤ä¸ªæˆ–å¤šä¸ªç‰¹å¾ç»„åˆèµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªæ–°çš„ç‰¹å¾ï¼Œç”¨æ¥è¡¨è¾¾å®ƒä»¬ä¹‹é—´çš„ç›¸äº’å…³ç³»</code></p>
<h3 id="CNN-å·ç§¯ç¥ç»"><a href="#CNN-å·ç§¯ç¥ç»" class="headerlink" title="CNN(å·ç§¯ç¥ç»)"></a>CNN(å·ç§¯ç¥ç»)</h3><pre><code class="hljs">            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ è¾“å…¥å±‚ï¼ˆå›¾åƒï¼‰     â”‚          
            â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ å·ç§¯å±‚ï¼ˆæå–å±€éƒ¨ç‰¹å¾â”‚ 
            â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ æ¿€æ´»å±‚ï¼ˆReLUï¼‰     â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ æ± åŒ–å±‚ï¼ˆä¸‹é‡‡æ ·ï¼‰   â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ å…¨è¿æ¥å±‚ï¼ˆåˆ†ç±»ï¼‰   â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ è¾“å‡ºå±‚ï¼ˆé¢„æµ‹ç»“æœï¼‰ â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>2ï¸âƒ£ å·ç§¯å±‚ï¼ˆConvolution Layerï¼‰<br>ä»è¾“å…¥ä¸­æå–å±€éƒ¨ç‰¹å¾ï¼Œæ¯”å¦‚è¾¹ç¼˜ã€è§’ç‚¹ã€çº¹ç†ç­‰ã€‚<br>3ï¸âƒ£ æ¿€æ´»å±‚ï¼ˆActivation Layerï¼‰<br>å·ç§¯åªæ˜¯çº¿æ€§è¿ç®—ï¼Œè¿˜ä¸å¤Ÿèªæ˜ã€‚<br>äºæ˜¯æˆ‘ä»¬åŠ ä¸€ä¸ªæ¿€æ´»å‡½æ•°ï¼ˆéçº¿æ€§å˜æ¢ï¼‰ï¼Œè®©ç½‘ç»œå¯ä»¥å­¦ä¹ å¤æ‚çš„æ¨¡å¼ã€‚<br>4ï¸âƒ£ æ± åŒ–å±‚ï¼ˆPooling Layerï¼‰<br>ä½œç”¨ï¼šé™ç»´ã€æå–ä¸»è¦ç‰¹å¾ã€é˜²æ­¢è¿‡æ‹Ÿåˆ<br>å…¨è¿æ¥å±‚ï¼ˆFully Connected Layerï¼‰</p>
<p>ç»è¿‡å‡ å±‚å·ç§¯å’Œæ± åŒ–åï¼Œæˆ‘ä»¬å¾—åˆ°äº†æŠ½è±¡çš„ç‰¹å¾è¡¨ç¤ºã€‚</p>
<p>ç„¶åæŠŠå®ƒâ€œæ‘Šå¹³â€ï¼ˆflattenï¼‰æˆä¸€ä¸ªå‘é‡ï¼Œé€å…¥å…¨è¿æ¥å±‚ï¼ˆDense Layerï¼‰ï¼Œ</p>
<h3 id="ğŸ§ -DNN-æ˜¯ä»€ä¹ˆï¼ŸDNNï¼ˆDeep-Neural-Networkï¼‰-æ·±åº¦ç¥ç»ç½‘ç»œ"><a href="#ğŸ§ -DNN-æ˜¯ä»€ä¹ˆï¼ŸDNNï¼ˆDeep-Neural-Networkï¼‰-æ·±åº¦ç¥ç»ç½‘ç»œ" class="headerlink" title="ğŸ§  DNN æ˜¯ä»€ä¹ˆï¼ŸDNNï¼ˆDeep Neural Networkï¼‰&#x3D; æ·±åº¦ç¥ç»ç½‘ç»œ"></a>ğŸ§  DNN æ˜¯ä»€ä¹ˆï¼ŸDNNï¼ˆDeep Neural Networkï¼‰&#x3D; æ·±åº¦ç¥ç»ç½‘ç»œ</h3><p>è¾“å…¥å±‚ â†’ éšè—å±‚1 â†’ éšè—å±‚2 â†’ â€¦ â†’ è¾“å‡ºå±‚</p>
<p>è¾“å…¥ï¼šä¸€ä¸ªç”¨æˆ·çš„ç‰¹å¾ï¼ˆå¹´é¾„ã€æ€§åˆ«ã€å…´è¶£ã€è§‚çœ‹æ—¶é•¿ç­‰ï¼‰<br>â†“<br>éšè—å±‚1ï¼šæå–ç®€å•ç»„åˆç‰¹å¾<br>â†“<br>éšè—å±‚2ï¼šæå–æ›´æ·±å±‚çš„æŠ½è±¡å…³ç³»<br>â†“<br>è¾“å‡ºå±‚ï¼šé¢„æµ‹ç‚¹å‡»æ¦‚ç‡ã€è¯„åˆ†æˆ–åˆ†ç±»ç»“æœ</p>
<h3 id="MLPï¼ˆMulti-Layer-Perceptronï¼‰å¤šå±‚æ„ŸçŸ¥æœº"><a href="#MLPï¼ˆMulti-Layer-Perceptronï¼‰å¤šå±‚æ„ŸçŸ¥æœº" class="headerlink" title="MLPï¼ˆMulti-Layer Perceptronï¼‰å¤šå±‚æ„ŸçŸ¥æœº"></a>MLPï¼ˆMulti-Layer Perceptronï¼‰å¤šå±‚æ„ŸçŸ¥æœº</h3><p>ğŸ§ ä¸€ã€MLP æ˜¯ä»€ä¹ˆï¼Ÿ<br><code> MLP æ˜¯ç”±å¤šä¸ªâ€œæ„ŸçŸ¥æœºï¼ˆPerceptronï¼‰â€å †å èµ·æ¥çš„ç¥ç»ç½‘ç»œï¼Œèƒ½å¤Ÿè‡ªåŠ¨ä»è¾“å…¥ç‰¹å¾ä¸­å­¦ä¹ å¤æ‚çš„æ˜ å°„å…³ç³»ã€‚</code></p>
<p>ğŸ§© äºŒã€ä»€ä¹ˆæ˜¯â€œæ„ŸçŸ¥æœºï¼ˆPerceptronï¼‰â€ï¼Ÿ<br>æ„ŸçŸ¥æœºæ˜¯ç¥ç»ç½‘ç»œä¸­æœ€åŸºæœ¬çš„â€œç¥ç»å…ƒâ€ï¼Œæ˜¯æ•´ä¸ªç½‘ç»œçš„æœ€å°è®¡ç®—å•å…ƒã€‚<br>å®ƒçš„æ•°å­¦å½¢å¼éå¸¸ç®€å•ğŸ‘‡ï¼šy&#x3D;f(Wx+b)<br>xï¼šè¾“å…¥ç‰¹å¾å‘é‡ï¼ˆæ¯”å¦‚å¹´é¾„ã€æ€§åˆ«ã€è§‚çœ‹æ—¶é•¿ç­‰ï¼‰</p>
<p>Wï¼šæƒé‡ï¼ˆæ¯ä¸ªç‰¹å¾çš„é‡è¦ç¨‹åº¦ï¼‰</p>
<p>bï¼šåç½®é¡¹</p>
<p>fï¼šæ¿€æ´»å‡½æ•°ï¼ˆReLUã€Sigmoidç­‰ï¼‰</p>
<p>å‡è®¾æˆ‘ä»¬è¦é¢„æµ‹â€œä¸€ä¸ªç”¨æˆ·æ˜¯å¦ä¼šç‚¹å‡»è§†é¢‘â€ï¼Œ<br>è¾“å…¥ä¸¤ä¸ªç‰¹å¾ï¼š</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">x1</span> = ç”¨æˆ·æ˜¯å¦å–œæ¬¢è¿™ä¸ªä¸»é¢˜<br><span class="hljs-attr">x2</span> = è§†é¢‘æ—¶é•¿<br></code></pre></td></tr></table></figure>
<p>æ¨¡å‹è®¡ç®—ï¼š<br>y&#x3D;f(0.8x1â€‹+0.2x2â€‹âˆ’0.3)<br>è¾“å‡ºä¸€ä¸ªæ¦‚ç‡ï¼Œæ¯”å¦‚ 0.9ï¼Œè¡¨ç¤ºç‚¹å‡»çš„å¯èƒ½æ€§å¾ˆé«˜ã€‚</p>
<h3 id="ğŸ”—-â€œå¤šå±‚æ„ŸçŸ¥æœºâ€æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ"><a href="#ğŸ”—-â€œå¤šå±‚æ„ŸçŸ¥æœºâ€æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ" class="headerlink" title="ğŸ”— â€œå¤šå±‚æ„ŸçŸ¥æœºâ€æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ"></a>ğŸ”— â€œå¤šå±‚æ„ŸçŸ¥æœºâ€æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</h3><p>å•ä¸ªæ„ŸçŸ¥æœºå¤ªç®€å•ï¼Œåªèƒ½åšçº¿æ€§åˆ†ç±»ï¼ˆåƒä¸€æ¡ç›´çº¿åˆ†ç•Œï¼‰ã€‚<br>äºæ˜¯æˆ‘ä»¬å åŠ å¤šå±‚ï¼šè¾“å…¥å±‚ â†’ éšè—å±‚1 â†’ éšè—å±‚2 â†’ è¾“å‡ºå±‚<br>æ¯ä¸€å±‚éƒ½æ˜¯è‹¥å¹²ä¸ªæ„ŸçŸ¥æœºï¼ˆç¥ç»å…ƒï¼‰ï¼Œå±‚ä¸å±‚ä¹‹é—´å…¨è¿æ¥ï¼ˆfully connectedï¼‰ã€‚</p>
<p>é€šè¿‡å¤šå±‚éçº¿æ€§å˜æ¢ï¼Œæ¨¡å‹èƒ½å­¦ä¹ <br>ç‰¹å¾çš„ç»„åˆï¼›</p>
<p>é«˜é˜¶ç‰¹å¾äº¤äº’ï¼›</p>
<p>éçº¿æ€§å…³ç³»</p>
<p>ğŸ“˜ ä¸¾ä¸ªç›´è§‚æ¯”å–»ï¼š<br>å•å±‚æ„ŸçŸ¥æœºï¼šåƒä¸€æ¡ç›´çº¿ï¼Œåªèƒ½åˆ†å¼€ç®€å•çš„ä¸¤ç±»ï¼›<br>å¤šå±‚æ„ŸçŸ¥æœºï¼ˆMLPï¼‰ï¼šåƒä¸€å¼ å¼¯æ›²çš„æ›²çº¿ï¼Œå¯ä»¥é€‚åº”å¤æ‚è¾¹ç•Œã€‚</p>
<p>âš™ï¸ å››ã€MLP çš„ç»“æ„å›¾ï¼ˆæ–‡å­—ç‰ˆï¼‰<br>è¾“å…¥å±‚ï¼ˆFeature Inputï¼‰<br>   â†“<br>éšè—å±‚1ï¼šå¤šä¸ªç¥ç»å…ƒ + æ¿€æ´»å‡½æ•°<br>   â†“<br>éšè—å±‚2ï¼šå¤šä¸ªç¥ç»å…ƒ + æ¿€æ´»å‡½æ•°<br>   â†“<br>è¾“å‡ºå±‚ï¼ˆé¢„æµ‹ç»“æœï¼‰</p>
<h3 id="æ¢¯åº¦ä¸‹é™"><a href="#æ¢¯åº¦ä¸‹é™" class="headerlink" title="æ¢¯åº¦ä¸‹é™"></a>æ¢¯åº¦ä¸‹é™</h3><p>åœ¨æœºå™¨å­¦ä¹ æˆ–æ·±åº¦å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬æœ‰ï¼šL(Î¸)<br>Lï¼šæŸå¤±å‡½æ•°ï¼ˆLoss Functionï¼‰ï¼Œè¡¡é‡æ¨¡å‹é¢„æµ‹ä¸çœŸå®çš„è¯¯å·®<br>Î¸ï¼šæ¨¡å‹å‚æ•°ï¼ˆä¾‹å¦‚æƒé‡ Wã€åç½® bï¼‰ç›®æ ‡æ˜¯æ‰¾åˆ°ä¸€ç»„å‚æ•° ğœƒï¼Œä½¿æŸå¤±å°½å¯èƒ½å°<br>äºæ˜¯æˆ‘ä»¬ç”¨æ¢¯åº¦ä¸‹é™æ³•ï¼šÎ¸:&#x3D;Î¸âˆ’Î·â‹…âˆ‡Î¸â€‹L(Î¸)  å­¦ä¹ ç‡ï¼ˆlearning rateï¼‰ï¼Œå†³å®šæ¯æ¬¡èµ°å¤šå¤§æ­¥</p>
<h2 id="ä¸€ã€ä»€ä¹ˆæ˜¯åŒå¡”æ¨¡å‹ï¼Ÿ"><a href="#ä¸€ã€ä»€ä¹ˆæ˜¯åŒå¡”æ¨¡å‹ï¼Ÿ" class="headerlink" title="ä¸€ã€ä»€ä¹ˆæ˜¯åŒå¡”æ¨¡å‹ï¼Ÿ"></a>ä¸€ã€ä»€ä¹ˆæ˜¯åŒå¡”æ¨¡å‹ï¼Ÿ</h2><p>å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š<br>ğŸ‘‰ æŠŠâ€œç”¨æˆ·â€å’Œâ€œç‰©å“â€åˆ†å¼€å»ºæ¨¡ï¼Œå„è‡ªç”¨ä¸€ä¸ªâ€œå¡”â€æ¥è¡¨ç¤ºï¼Œç„¶åé€šè¿‡æ¯”è¾ƒå®ƒä»¬çš„å‘é‡ï¼ˆembeddingï¼‰æ¥è®¡ç®—åŒ¹é…ç¨‹åº¦ã€‚</p>
<h2 id="äºŒã€ç»“æ„é•¿ä»€ä¹ˆæ ·ï¼Ÿ"><a href="#äºŒã€ç»“æ„é•¿ä»€ä¹ˆæ ·ï¼Ÿ" class="headerlink" title="äºŒã€ç»“æ„é•¿ä»€ä¹ˆæ ·ï¼Ÿ"></a>äºŒã€ç»“æ„é•¿ä»€ä¹ˆæ ·ï¼Ÿ</h2><pre><code class="hljs">  ç”¨æˆ·ç‰¹å¾ --&gt; [ç”¨æˆ·å¡”] ---&gt; ç”¨æˆ·å‘é‡ U
                                     \
                                      &gt; ç‚¹ç§¯ï¼ˆæˆ–ç›¸ä¼¼åº¦ï¼‰ --&gt; é¢„æµ‹åˆ†æ•°
                                     /
  ç‰©å“ç‰¹å¾ --&gt; [ç‰©å“å¡”] ---&gt; ç‰©å“å‘é‡ I
</code></pre>
<p><strong>å·¦è¾¹å¡”</strong>ï¼šç”¨æˆ·å¡”ï¼ˆUser Towerï¼‰</p>
<ul>
<li>è¾“å…¥ï¼šç”¨æˆ·çš„ç‰¹å¾ï¼ˆå¦‚IDã€æ€§åˆ«ã€å…´è¶£ã€å†å²è¡Œä¸ºç­‰ï¼‰</li>
<li>è¾“å‡ºï¼šä¸€ä¸ªç”¨æˆ·å‘é‡ Uï¼ˆç”¨æ•°å­—ç»„æˆçš„ä¸€ä¸ªå‘é‡ï¼Œæ¯”å¦‚ [0.1, 0.5, 0.3, â€¦]ï¼‰</li>
</ul>
<p><strong>å³è¾¹å¡”</strong>ï¼šç‰©å“å¡”ï¼ˆItem Towerï¼‰</p>
<ul>
<li>è¾“å…¥ï¼šç‰©å“çš„ç‰¹å¾ï¼ˆå¦‚å•†å“IDã€ç±»åˆ«ã€æ ‡ç­¾ã€æ ‡é¢˜ç­‰ï¼‰</li>
<li>è¾“å‡ºï¼šä¸€ä¸ªç‰©å“å‘é‡ I</li>
</ul>
<p><em><strong>ä¸¤å¡”çš„å‚æ•°é€šå¸¸ä¸å…±äº«ï¼Œè¾“å‡ºç»´åº¦ç›¸åŒçš„å‘é‡ï¼ˆå¦‚128ç»´ï¼‰ã€‚</strong></em></p>
<p><em><strong>ç”¨æˆ·å¡”å’Œç‰©å“å¡”ä¸æ˜¯ç‹¬ç«‹è®­ç»ƒçš„ï¼Œè€Œæ˜¯é€šè¿‡è”åˆä¼˜åŒ–ç›®æ ‡ç«¯åˆ°ç«¯è®­ç»ƒã€‚äºŒè€…çš„Embeddingéœ€è¦åœ¨åŒä¸€å‘é‡ç©ºé—´ä¸­å¯¹é½ã€‚</strong></em></p>
<p><strong>åŒ¹é…éƒ¨åˆ†</strong>ï¼š</p>
<ul>
<li>æ¯”è¾ƒ U å’Œ I çš„ç›¸ä¼¼åº¦ï¼ˆé€šå¸¸ç”¨ç‚¹ç§¯æˆ–ä½™å¼¦ç›¸ä¼¼åº¦ï¼‰ï¼Œ</li>
<li>ç›¸ä¼¼åº¦è¶Šé«˜ï¼Œè¯´æ˜è¿™ä¸ªç”¨æˆ·è¶Šå¯èƒ½å–œæ¬¢è¿™ä¸ªç‰©å“ã€‚</li>
</ul>
<h2 id="ä¸‰ã€ä¸ºä»€ä¹ˆå«â€œåŒå¡”â€ï¼Ÿ"><a href="#ä¸‰ã€ä¸ºä»€ä¹ˆå«â€œåŒå¡”â€ï¼Ÿ" class="headerlink" title="ä¸‰ã€ä¸ºä»€ä¹ˆå«â€œåŒå¡”â€ï¼Ÿ"></a>ä¸‰ã€ä¸ºä»€ä¹ˆå«â€œåŒå¡”â€ï¼Ÿ</h2><ul>
<li>å› ä¸ºæ¨¡å‹çš„ç»“æ„çœ‹èµ·æ¥åƒä¸¤åº§å¹¶åˆ—çš„å¡”ï¼š</li>
<li>ä¸¤è¾¹éƒ½å„è‡ªæœ‰å‡ å±‚ç¥ç»ç½‘ç»œï¼ˆç”¨æ¥å­¦ä¹ ç‰¹å¾çš„è¡¨ç¤ºï¼‰ã€‚</li>
<li>æœ€åæ‰åœ¨é¡¶éƒ¨â€œç›¸é‡â€è¿›è¡ŒåŒ¹é…ã€‚</li>
<li>è¿™ä¸¤åº§å¡”å¯ä»¥æ˜¯ç›¸åŒç»“æ„çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸åŒç»“æ„çš„ã€‚</li>
</ul>
<h2 id="å››ã€æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ"><a href="#å››ã€æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ" class="headerlink" title="å››ã€æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ"></a>å››ã€æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ</h2><p><code>åŒå¡”æ¨¡å‹æœ€å‰å®³çš„ä¸€ç‚¹æ˜¯â€”â€”æ•ˆç‡é«˜ï¼</code></p>
<ol>
<li><p>ç¦»çº¿è®¡ç®—ç‰©å“å‘é‡<br>æ‰€æœ‰<strong>ç‰©å“çš„å‘é‡</strong>å¯ä»¥<strong>æå‰ç®—å¥½å¹¶å­˜èµ·æ¥</strong>ã€‚<br>è¿™æ ·å½“æœ‰ä¸€ä¸ª<strong>ç”¨æˆ·æ¥æ—¶ï¼Œåªéœ€è¦è®¡ç®—ä¸€æ¬¡ç”¨æˆ·å‘é‡</strong>ï¼Œç„¶åå’Œ<strong>æ•°æ®åº“é‡Œæ‰€æœ‰ç‰©å“å‘é‡åšç›¸ä¼¼åº¦æœç´¢</strong>ï¼Œå°±èƒ½å¿«é€Ÿæ‰¾åˆ°æœ€åŒ¹é…çš„ç‰©å“ã€‚<br>ğŸ‘‰ è¿™æ¯”æ¯æ¬¡éƒ½è¦é‡æ–°è®¡ç®—â€œç”¨æˆ·Ã—ç‰©å“â€çš„ç»„åˆè¦å¿«å¾—å¤šï¼</p>
</li>
<li><p>å¯æ‰©å±•æ€§å¼º<br>é€‚åˆä¸Šäº¿çº§çš„ç‰©å“ï¼ˆæ¯”å¦‚æŠ–éŸ³è§†é¢‘ã€æ·˜å®å•†å“ã€YouTubeè§†é¢‘ç­‰ï¼‰ã€‚</p>
</li>
<li><p>å¯çµæ´»æ‰©å±•<br>å¯ä»¥æŠŠç‰¹å¾æ¢æˆåˆ«çš„ï¼ˆæ¯”å¦‚æ–‡å­—ã€å›¾åƒã€è¯­éŸ³ï¼‰ï¼Œä»ç„¶é€‚ç”¨ã€‚</p>
</li>
</ol>
<h2 id="åŒå¡”æ¨¡å‹ä»£ç å®ç°"><a href="#åŒå¡”æ¨¡å‹ä»£ç å®ç°" class="headerlink" title="åŒå¡”æ¨¡å‹ä»£ç å®ç°"></a>åŒå¡”æ¨¡å‹ä»£ç å®ç°</h2><h3 id="å‡½æ•°è§£é‡Š"><a href="#å‡½æ•°è§£é‡Š" class="headerlink" title="å‡½æ•°è§£é‡Š"></a>å‡½æ•°è§£é‡Š</h3><p>1ï¸âƒ£ Dot æ˜¯ä»€ä¹ˆ <code>similarity = Dot(axes=-1, normalize=True, name=&quot;cosine_similarity&quot;)([user_embedding, item_embedding])</code><br>Dot æ˜¯ Keras çš„ä¸€ä¸ªå±‚ï¼ˆtensorflow.keras.layers.Dotï¼‰ï¼Œç”¨äºè®¡ç®—ä¸¤ä¸ªå¼ é‡ä¹‹é—´çš„ ç‚¹ç§¯ï¼ˆdot productï¼‰ã€‚</p>
<p>ç‚¹ç§¯ï¼ˆdot productï¼‰&#x3D; ä¸¤ä¸ªå‘é‡å¯¹åº”å…ƒç´ ç›¸ä¹˜åæ±‚å’Œã€‚<br>ä¾‹å¦‚ï¼š<br>u &#x3D; [1, 2, 3]<br>v &#x3D; [4, 5, 6]<br>uÂ·v &#x3D; 1Ã—4 + 2Ã—5 + 3Ã—6 &#x3D; 32</p>
<p>2ï¸âƒ£ axes&#x3D;-1 çš„å«ä¹‰</p>
<p>åœ¨æœ€åä¸€ä¸ªç»´åº¦ä¸Šè¿›è¡Œç‚¹ç§¯ã€‚<br>å‡è®¾ï¼š<br>user_embedding çš„å½¢çŠ¶æ˜¯ (batch_size, embedding_dim)ï¼Œæ¯”å¦‚ (5, 8)ï¼›<br>item_embedding çš„å½¢çŠ¶æ˜¯ (batch_size, embedding_dim)ï¼Œæ¯”å¦‚ (5, 8)ã€‚</p>
<p>é‚£ä¹ˆï¼š<br>Dot(axes&#x3D;-1) ä¼šå¯¹æ¯å¯¹ (user[i], item[i]) è¿›è¡Œæœ€åä¸€ä¸ªç»´åº¦çš„ç‚¹ç§¯ï¼›<br>è¾“å‡ºçš„å½¢çŠ¶ä¼šæ˜¯ (batch_size, 1)ã€‚<br>ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸€å¯¹ï¼ˆç”¨æˆ·å‘é‡ï¼Œç‰©å“å‘é‡ï¼‰éƒ½ä¼šå¾—åˆ°ä¸€ä¸ªç›¸ä¼¼åº¦åˆ†æ•°ã€‚</p>
<p>3ï¸âƒ£ normalize&#x3D;True æ˜¯ä»€ä¹ˆï¼Ÿ<br><code>åœ¨åšç‚¹ç§¯å‰ï¼Œå…ˆæŠŠä¸¤ä¸ªå‘é‡éƒ½è¿›è¡Œ L2 å½’ä¸€åŒ–ï¼ˆnormalizeï¼‰ã€‚</code><br>L2 å½’ä¸€åŒ–ï¼šæŠŠå‘é‡çš„é•¿åº¦ï¼ˆæ¨¡ï¼‰å˜æˆ 1ï¼š</p>
<p>4ï¸âƒ£ æ‰€ä»¥è¿™å±‚çš„åŠŸèƒ½æ˜¯ï¼š<code>âœ… è®¡ç®—ç”¨æˆ·å‘é‡ä¸ç‰©å“å‘é‡çš„ä½™å¼¦ç›¸ä¼¼åº¦ã€‚</code></p>
<h3 id="self-model-compile-optimizer-Adam-learning-rate-0-001-loss-â€binary-crossentropyâ€-metrics-â€œaccuracyâ€-è¿™æ˜¯å¹²å˜›çš„ï¼Ÿ"><a href="#self-model-compile-optimizer-Adam-learning-rate-0-001-loss-â€binary-crossentropyâ€-metrics-â€œaccuracyâ€-è¿™æ˜¯å¹²å˜›çš„ï¼Ÿ" class="headerlink" title="self.model.compile( optimizer&#x3D;Adam(learning_rate&#x3D;0.001), loss&#x3D;â€binary_crossentropyâ€, metrics&#x3D;[â€œaccuracyâ€] ) è¿™æ˜¯å¹²å˜›çš„ï¼Ÿ"></a>self.model.compile( optimizer&#x3D;Adam(learning_rate&#x3D;0.001), loss&#x3D;â€binary_crossentropyâ€, metrics&#x3D;[â€œaccuracyâ€] ) è¿™æ˜¯å¹²å˜›çš„ï¼Ÿ</h3><p>ğŸ’¡ å‘Šè¯‰ TensorFlowï¼š<br>â€œæˆ‘è¿™ä¸ªæ¨¡å‹è¦æ€ä¹ˆè®­ç»ƒã€ç”¨ä»€ä¹ˆä¼˜åŒ–å™¨ã€ç”¨ä»€ä¹ˆæŸå¤±å‡½æ•°ã€ä»¥åŠåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å…³æ³¨å“ªäº›æŒ‡æ ‡ã€‚â€</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">åŒå¡”æ¨¡å‹ï¼ˆTwo-Tower Modelï¼‰å®Œæ•´å®ç°</span><br><span class="hljs-string">æ¥æºï¼šhttps://blog.csdn.net/goTsHgo/article/details/144259481</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> tensorflow <span class="hljs-keyword">as</span> tf<br><span class="hljs-keyword">from</span> tensorflow.keras.layers <span class="hljs-keyword">import</span> Input, Dense, Dot, Flatten, Concatenate<br><span class="hljs-keyword">from</span> tensorflow.keras.models <span class="hljs-keyword">import</span> Model<br><span class="hljs-keyword">from</span> tensorflow.keras.optimizers <span class="hljs-keyword">import</span> Adam<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">import</span> matplotlib<br><br>matplotlib.use(<span class="hljs-string">&#x27;Agg&#x27;</span>)  <span class="hljs-comment"># ä½¿ç”¨éäº¤äº’å¼åç«¯</span><br>plt.rcParams[<span class="hljs-string">&#x27;font.sans-serif&#x27;</span>] = [<span class="hljs-string">&#x27;WenQuanYi Zen Hei&#x27;</span>]  <span class="hljs-comment"># è®¾ç½®ä¸­æ–‡å­—ä½“</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TwoTowerModel</span>:<br>    <span class="hljs-string">&quot;&quot;&quot;åŒå¡”æ¨¡å‹å®ç°ç±»&quot;&quot;&quot;</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, user_feature_dim, item_feature_dim, embedding_dim=<span class="hljs-number">8</span></span>):<br>        <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        åˆå§‹åŒ–åŒå¡”æ¨¡å‹</span><br><span class="hljs-string"></span><br><span class="hljs-string">        å‚æ•°:</span><br><span class="hljs-string">            user_feature_dim: ç”¨æˆ·ç‰¹å¾ç»´åº¦</span><br><span class="hljs-string">            item_feature_dim: ç‰©å“ç‰¹å¾ç»´åº¦</span><br><span class="hljs-string">            embedding_dim: åµŒå…¥å‘é‡ç»´åº¦</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        <span class="hljs-variable language_">self</span>.user_feature_dim = user_feature_dim<br>        <span class="hljs-variable language_">self</span>.item_feature_dim = item_feature_dim<br>        <span class="hljs-variable language_">self</span>.embedding_dim = embedding_dim          <span class="hljs-comment">#åŒå¡”è¾“å‡ºç»Ÿä¸€ embedding ç»´æ•°</span><br>        <span class="hljs-variable language_">self</span>.model = <span class="hljs-literal">None</span>                           <span class="hljs-comment"># å®Œæ•´è®­ç»ƒæ¨¡å‹ï¼ˆç”¨æˆ·+ç‰©å“â†’ç›¸ä¼¼åº¦ï¼‰</span><br>        <span class="hljs-variable language_">self</span>.user_model = <span class="hljs-literal">None</span>                      <span class="hljs-comment"># ä»…ç”¨æˆ·å¡”ï¼ˆç”¨æˆ·â†’å‘é‡ï¼‰</span><br>        <span class="hljs-variable language_">self</span>.item_model = <span class="hljs-literal">None</span>                      <span class="hljs-comment"># ä»…ç‰©å“å¡”ï¼ˆç‰©å“â†’å‘é‡ï¼‰</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">build_model</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;æ„å»ºåŒå¡”æ¨¡å‹æ¶æ„&quot;&quot;&quot;</span><br>        <span class="hljs-comment"># ç”¨æˆ·å¡”</span><br>        user_input = Input(shape=(<span class="hljs-variable language_">self</span>.user_feature_dim,), name=<span class="hljs-string">&quot;user_input&quot;</span>)   <span class="hljs-comment"># å®šä¹‰ä¸€ä¸ª Keras è¾“å…¥å¼ é‡ï¼Œå½¢çŠ¶ (user_feature_dim,)ï¼Œç”¨äºé€å…¥ç”¨æˆ·ç‰¹å¾ï¼ˆæ¯”å¦‚ [æ€§åˆ«, å¹´é¾„, å†å²è¡Œä¸º]ï¼‰ã€‚</span><br>        <span class="hljs-comment"># æŠŠåˆšæ‰é‚£ä¸ªè¾“å…¥å¼ é‡è¿åˆ°ä¸€å±‚å…¨è¿æ¥ç¥ç»å…ƒï¼Œè®©å®ƒè¾“å‡ºä¸€ä¸ªå›ºå®šé•¿åº¦çš„å‘é‡ï¼Œè¿™å°±å«â€˜ç”¨æˆ·å¡”â€™ã€‚</span><br>        user_embedding = Dense(<span class="hljs-variable language_">self</span>.embedding_dim, activation=<span class="hljs-string">&quot;relu&quot;</span>, name=<span class="hljs-string">&quot;user_embedding&quot;</span>)(user_input)<br><br>        <span class="hljs-comment"># ç‰©å“å¡”</span><br>        item_input = Input(shape=(<span class="hljs-variable language_">self</span>.item_feature_dim,), name=<span class="hljs-string">&quot;item_input&quot;</span>)<br>        item_embedding = Dense(<span class="hljs-variable language_">self</span>.embedding_dim, activation=<span class="hljs-string">&quot;relu&quot;</span>, name=<span class="hljs-string">&quot;item_embedding&quot;</span>)(item_input)<br><br>        <span class="hljs-comment"># åŒ¹é…å±‚ï¼šä½™å¼¦ç›¸ä¼¼åº¦</span><br>        <span class="hljs-comment"># ç”¨æˆ·å¡”è¾“å‡ºçš„å‘é‡å’Œç‰©å“å¡”è¾“å‡ºçš„å‘é‡è¿æ¥åœ¨ä¸€èµ·ï¼Œè®¡ç®—å®ƒä»¬çš„â€œç›¸ä¼¼åº¦â€ï¼Œä»è€Œåˆ¤æ–­ç”¨æˆ·å’Œç‰©å“æ˜¯å¦åŒ¹é…ï¼ˆå–œæ¬¢ / ä¸å–œæ¬¢ï¼‰ã€‚</span><br>        similarity = Dot(axes=-<span class="hljs-number">1</span>, normalize=<span class="hljs-literal">True</span>, name=<span class="hljs-string">&quot;cosine_similarity&quot;</span>)([user_embedding, item_embedding])<br><br>        <span class="hljs-comment"># æ„å»ºå®Œæ•´æ¨¡å‹</span><br>        <span class="hljs-variable language_">self</span>.model = Model(inputs=[user_input, item_input], outputs=similarity)<br><br>        <span class="hljs-comment"># æ„å»ºç”¨æˆ·å¡”æ¨¡å‹ï¼ˆç”¨äºç”Ÿæˆç”¨æˆ·å‘é‡ï¼‰</span><br>        <span class="hljs-variable language_">self</span>.user_model = Model(inputs=user_input, outputs=user_embedding)<br><br>        <span class="hljs-comment"># æ„å»ºç‰©å“å¡”æ¨¡å‹ï¼ˆç”¨äºç”Ÿæˆç‰©å“å‘é‡ï¼‰</span><br>        <span class="hljs-variable language_">self</span>.item_model = Model(inputs=item_input, outputs=item_embedding)<br><br>        <span class="hljs-comment"># ç¼–è¯‘æ¨¡å‹</span><br>        <span class="hljs-variable language_">self</span>.model.<span class="hljs-built_in">compile</span>(<br>            optimizer=Adam(learning_rate=<span class="hljs-number">0.001</span>),<br>            loss=<span class="hljs-string">&quot;binary_crossentropy&quot;</span>,<br>            metrics=[<span class="hljs-string">&quot;accuracy&quot;</span>]<br>        )<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.model<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">prepare_data</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;å‡†å¤‡è®­ç»ƒå’Œæµ‹è¯•æ•°æ®&quot;&quot;&quot;</span><br>        <span class="hljs-comment"># ç”¨æˆ·ç‰¹å¾ï¼šæ€§åˆ«ï¼ˆ0=å¥³, 1=ç”·ï¼‰ã€å¹´é¾„ï¼ˆ18-60ï¼‰ã€å†å²è¡Œä¸ºï¼ˆç‰©å“IDï¼‰</span><br>        user_features = np.array([<br>            [<span class="hljs-number">1</span>, <span class="hljs-number">25</span>, <span class="hljs-number">101</span>],  <span class="hljs-comment"># ç”¨æˆ·1ï¼šç”·ï¼Œ25å²ï¼Œå†å²è¡Œä¸ºç‰©å“101</span><br>            [<span class="hljs-number">0</span>, <span class="hljs-number">30</span>, <span class="hljs-number">102</span>],  <span class="hljs-comment"># ç”¨æˆ·2ï¼šå¥³ï¼Œ30å²ï¼Œå†å²è¡Œä¸ºç‰©å“102</span><br>            [<span class="hljs-number">1</span>, <span class="hljs-number">35</span>, <span class="hljs-number">103</span>],  <span class="hljs-comment"># ç”¨æˆ·3ï¼šç”·ï¼Œ35å²ï¼Œå†å²è¡Œä¸ºç‰©å“103</span><br>            [<span class="hljs-number">0</span>, <span class="hljs-number">28</span>, <span class="hljs-number">104</span>],  <span class="hljs-comment"># ç”¨æˆ·4ï¼šå¥³ï¼Œ28å²ï¼Œå†å²è¡Œä¸ºç‰©å“104</span><br>            [<span class="hljs-number">1</span>, <span class="hljs-number">22</span>, <span class="hljs-number">105</span>],  <span class="hljs-comment"># ç”¨æˆ·5ï¼šç”·ï¼Œ22å²ï¼Œå†å²è¡Œä¸ºç‰©å“105</span><br>        ])<br><br>        <span class="hljs-comment"># ç‰©å“ç‰¹å¾ï¼šç±»åˆ«ï¼ˆ0=ç”µå½±, 1=ä¹¦ç±ï¼‰ã€çƒ­åº¦ï¼ˆ0-1ï¼‰</span><br>        item_features = np.array([<br>            [<span class="hljs-number">0</span>, <span class="hljs-number">0.8</span>],  <span class="hljs-comment"># ç‰©å“1ï¼šç”µå½±ï¼Œçƒ­åº¦0.8</span><br>            [<span class="hljs-number">1</span>, <span class="hljs-number">0.5</span>],  <span class="hljs-comment"># ç‰©å“2ï¼šä¹¦ç±ï¼Œçƒ­åº¦0.5</span><br>            [<span class="hljs-number">0</span>, <span class="hljs-number">0.9</span>],  <span class="hljs-comment"># ç‰©å“3ï¼šç”µå½±ï¼Œçƒ­åº¦0.9</span><br>            [<span class="hljs-number">1</span>, <span class="hljs-number">0.7</span>],  <span class="hljs-comment"># ç‰©å“4ï¼šä¹¦ç±ï¼Œçƒ­åº¦0.7</span><br>            [<span class="hljs-number">0</span>, <span class="hljs-number">0.6</span>],  <span class="hljs-comment"># ç‰©å“5ï¼šç”µå½±ï¼Œçƒ­åº¦0.6</span><br>        ])<br><br>        <span class="hljs-comment"># æ ‡ç­¾ï¼šç”¨æˆ·æ˜¯å¦å–œæ¬¢è¯¥ç‰©å“</span><br>        labels = np.array([<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>])  <span class="hljs-comment"># æ­£æ ·æœ¬å’Œè´Ÿæ ·æœ¬</span><br><br>        <span class="hljs-keyword">return</span> user_features, item_features, labels<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">train_model</span>(<span class="hljs-params">self, epochs=<span class="hljs-number">50</span>, batch_size=<span class="hljs-number">2</span></span>):<br>        <span class="hljs-string">&quot;&quot;&quot;è®­ç»ƒæ¨¡å‹&quot;&quot;&quot;</span><br>        user_features, item_features, labels = <span class="hljs-variable language_">self</span>.prepare_data()<br><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;å¼€å§‹è®­ç»ƒåŒå¡”æ¨¡å‹...&quot;</span>)<br>        history = <span class="hljs-variable language_">self</span>.model.fit(<br>            [user_features, item_features],<br>            labels,<br>            epochs=epochs,<br>            batch_size=batch_size,<br>            verbose=<span class="hljs-number">1</span>,<br>            validation_split=<span class="hljs-number">0.2</span><br>        )<br><br>        <span class="hljs-keyword">return</span> history<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">predict_similarity</span>(<span class="hljs-params">self, user_features, item_features</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;é¢„æµ‹ç”¨æˆ·å’Œç‰©å“çš„ç›¸ä¼¼åº¦&quot;&quot;&quot;</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.model.predict([user_features, item_features])<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_user_embedding</span>(<span class="hljs-params">self, user_features</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;è·å–ç”¨æˆ·åµŒå…¥å‘é‡&quot;&quot;&quot;</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.user_model.predict(user_features)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_item_embedding</span>(<span class="hljs-params">self, item_features</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;è·å–ç‰©å“åµŒå…¥å‘é‡&quot;&quot;&quot;</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.item_model.predict(item_features)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">visualize_training</span>(<span class="hljs-params">self, history</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;å¯è§†åŒ–è®­ç»ƒè¿‡ç¨‹&quot;&quot;&quot;</span><br>        fig, ((ax1, ax2), (ax3, ax4)) = plt.subplots(<span class="hljs-number">2</span>, <span class="hljs-number">2</span>, figsize=(<span class="hljs-number">15</span>, <span class="hljs-number">12</span>))<br><br>        <span class="hljs-comment"># è®­ç»ƒæŸå¤±</span><br>        ax1.plot(history.history[<span class="hljs-string">&#x27;loss&#x27;</span>], label=<span class="hljs-string">&#x27;è®­ç»ƒæŸå¤±&#x27;</span>)<br>        ax1.plot(history.history[<span class="hljs-string">&#x27;val_loss&#x27;</span>], label=<span class="hljs-string">&#x27;éªŒè¯æŸå¤±&#x27;</span>)<br>        ax1.set_title(<span class="hljs-string">&#x27;æ¨¡å‹æŸå¤±&#x27;</span>)<br>        ax1.set_xlabel(<span class="hljs-string">&#x27;è½®æ¬¡&#x27;</span>)<br>        ax1.set_ylabel(<span class="hljs-string">&#x27;æŸå¤±&#x27;</span>)<br>        ax1.legend()<br>        ax1.grid(<span class="hljs-literal">True</span>)<br><br>        <span class="hljs-comment"># è®­ç»ƒå‡†ç¡®ç‡</span><br>        ax2.plot(history.history[<span class="hljs-string">&#x27;accuracy&#x27;</span>], label=<span class="hljs-string">&#x27;è®­ç»ƒå‡†ç¡®ç‡&#x27;</span>)<br>        ax2.plot(history.history[<span class="hljs-string">&#x27;val_accuracy&#x27;</span>], label=<span class="hljs-string">&#x27;éªŒè¯å‡†ç¡®ç‡&#x27;</span>)<br>        ax2.set_title(<span class="hljs-string">&#x27;æ¨¡å‹å‡†ç¡®ç‡&#x27;</span>)<br>        ax2.set_xlabel(<span class="hljs-string">&#x27;è½®æ¬¡&#x27;</span>)<br>        ax2.set_ylabel(<span class="hljs-string">&#x27;å‡†ç¡®ç‡&#x27;</span>)<br>        ax2.legend()<br>        ax2.grid(<span class="hljs-literal">True</span>)<br><br>        <span class="hljs-comment"># ç”¨æˆ·åµŒå…¥å‘é‡å¯è§†åŒ–</span><br>        user_features, _, _ = <span class="hljs-variable language_">self</span>.prepare_data()<br>        user_embeddings = <span class="hljs-variable language_">self</span>.get_user_embedding(user_features)<br><br>        ax3.scatter(user_embeddings[:, <span class="hljs-number">0</span>], user_embeddings[:, <span class="hljs-number">1</span>],<br>                    c=[<span class="hljs-string">&#x27;red&#x27;</span>, <span class="hljs-string">&#x27;blue&#x27;</span>, <span class="hljs-string">&#x27;green&#x27;</span>, <span class="hljs-string">&#x27;orange&#x27;</span>, <span class="hljs-string">&#x27;purple&#x27;</span>], s=<span class="hljs-number">100</span>)<br>        <span class="hljs-keyword">for</span> i, txt <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>([<span class="hljs-string">&#x27;ç”¨æˆ·1&#x27;</span>, <span class="hljs-string">&#x27;ç”¨æˆ·2&#x27;</span>, <span class="hljs-string">&#x27;ç”¨æˆ·3&#x27;</span>, <span class="hljs-string">&#x27;ç”¨æˆ·4&#x27;</span>, <span class="hljs-string">&#x27;ç”¨æˆ·5&#x27;</span>]):<br>            ax3.annotate(txt, (user_embeddings[i, <span class="hljs-number">0</span>], user_embeddings[i, <span class="hljs-number">1</span>]))<br>        ax3.set_title(<span class="hljs-string">&#x27;ç”¨æˆ·åµŒå…¥å‘é‡å¯è§†åŒ–&#x27;</span>)<br>        ax3.set_xlabel(<span class="hljs-string">&#x27;ç»´åº¦1&#x27;</span>)<br>        ax3.set_ylabel(<span class="hljs-string">&#x27;ç»´åº¦2&#x27;</span>)<br>        ax3.grid(<span class="hljs-literal">True</span>)<br><br>        <span class="hljs-comment"># ç‰©å“åµŒå…¥å‘é‡å¯è§†åŒ–</span><br>        _, item_features, _ = <span class="hljs-variable language_">self</span>.prepare_data()<br>        item_embeddings = <span class="hljs-variable language_">self</span>.get_item_embedding(item_features)<br><br>        ax4.scatter(item_embeddings[:, <span class="hljs-number">0</span>], item_embeddings[:, <span class="hljs-number">1</span>],<br>                    c=[<span class="hljs-string">&#x27;red&#x27;</span>, <span class="hljs-string">&#x27;blue&#x27;</span>, <span class="hljs-string">&#x27;green&#x27;</span>, <span class="hljs-string">&#x27;orange&#x27;</span>, <span class="hljs-string">&#x27;purple&#x27;</span>], s=<span class="hljs-number">100</span>)<br>        <span class="hljs-keyword">for</span> i, txt <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>([<span class="hljs-string">&#x27;ç‰©å“1&#x27;</span>, <span class="hljs-string">&#x27;ç‰©å“2&#x27;</span>, <span class="hljs-string">&#x27;ç‰©å“3&#x27;</span>, <span class="hljs-string">&#x27;ç‰©å“4&#x27;</span>, <span class="hljs-string">&#x27;ç‰©å“5&#x27;</span>]):<br>            ax4.annotate(txt, (item_embeddings[i, <span class="hljs-number">0</span>], item_embeddings[i, <span class="hljs-number">1</span>]))<br>        ax4.set_title(<span class="hljs-string">&#x27;ç‰©å“åµŒå…¥å‘é‡å¯è§†åŒ–&#x27;</span>)<br>        ax4.set_xlabel(<span class="hljs-string">&#x27;ç»´åº¦1&#x27;</span>)<br>        ax4.set_ylabel(<span class="hljs-string">&#x27;ç»´åº¦2&#x27;</span>)<br>        ax4.grid(<span class="hljs-literal">True</span>)<br><br>        plt.tight_layout()<br>        plt.savefig(<span class="hljs-string">&#x27;training_visualization.png&#x27;</span>, dpi=<span class="hljs-number">300</span>, bbox_inches=<span class="hljs-string">&#x27;tight&#x27;</span>)<br>        plt.close()<br><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è®­ç»ƒå¯è§†åŒ–å›¾è¡¨å·²ä¿å­˜ä¸º &#x27;training_visualization.png&#x27;&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">demonstrate_recommendation</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;æ¼”ç¤ºæ¨èåŠŸèƒ½&quot;&quot;&quot;</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n=== åŒå¡”æ¨¡å‹æ¨èæ¼”ç¤º ===&quot;</span>)<br><br>        <span class="hljs-comment"># æµ‹è¯•ç”¨æˆ·ç‰¹å¾ - ä¸ºæ¯ä¸ªç‰©å“å¤åˆ¶ç›¸åŒçš„ç”¨æˆ·ç‰¹å¾</span><br>        test_user = np.array([<br>            [<span class="hljs-number">1</span>, <span class="hljs-number">28</span>, <span class="hljs-number">101</span>],  <span class="hljs-comment"># ç”¨æˆ·ç‰¹å¾ï¼šç”·æ€§ï¼Œ28å²ï¼Œå†å²è¡Œä¸ºç‰©å“101</span><br>            [<span class="hljs-number">1</span>, <span class="hljs-number">28</span>, <span class="hljs-number">101</span>],<br>            [<span class="hljs-number">1</span>, <span class="hljs-number">28</span>, <span class="hljs-number">101</span>],<br>            [<span class="hljs-number">1</span>, <span class="hljs-number">28</span>, <span class="hljs-number">101</span>],<br>            [<span class="hljs-number">1</span>, <span class="hljs-number">28</span>, <span class="hljs-number">101</span>]<br>        ])<br><br>        <span class="hljs-comment"># æµ‹è¯•ç‰©å“ç‰¹å¾</span><br>        test_items = np.array([<br>            [<span class="hljs-number">0</span>, <span class="hljs-number">0.9</span>],  <span class="hljs-comment"># ç‰©å“1ï¼šç”µå½±ï¼Œçƒ­åº¦0.9</span><br>            [<span class="hljs-number">1</span>, <span class="hljs-number">0.7</span>],  <span class="hljs-comment"># ç‰©å“2ï¼šä¹¦ç±ï¼Œçƒ­åº¦0.7</span><br>            [<span class="hljs-number">0</span>, <span class="hljs-number">0.6</span>],  <span class="hljs-comment"># ç‰©å“3ï¼šç”µå½±ï¼Œçƒ­åº¦0.6</span><br>            [<span class="hljs-number">1</span>, <span class="hljs-number">0.8</span>],  <span class="hljs-comment"># ç‰©å“4ï¼šä¹¦ç±ï¼Œçƒ­åº¦0.8</span><br>            [<span class="hljs-number">0</span>, <span class="hljs-number">0.95</span>],  <span class="hljs-comment"># ç‰©å“5ï¼šç”µå½±ï¼Œçƒ­åº¦0.95</span><br>        ])<br><br>        <span class="hljs-comment"># è®¡ç®—ç›¸ä¼¼åº¦</span><br>        scores = <span class="hljs-variable language_">self</span>.predict_similarity(test_user, test_items)<br><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æµ‹è¯•ç”¨æˆ·ç‰¹å¾ï¼šç”·æ€§ï¼Œ28å²ï¼Œå†å²è¡Œä¸ºç‰©å“101&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\nç‰©å“æ¨èæ’åºï¼š&quot;</span>)<br><br>        items_info = [<span class="hljs-string">&#x27;ç”µå½±(çƒ­åº¦0.9)&#x27;</span>, <span class="hljs-string">&#x27;ä¹¦ç±(çƒ­åº¦0.7)&#x27;</span>, <span class="hljs-string">&#x27;ç”µå½±(çƒ­åº¦0.6)&#x27;</span>, <span class="hljs-string">&#x27;ä¹¦ç±(çƒ­åº¦0.8)&#x27;</span>, <span class="hljs-string">&#x27;ç”µå½±(çƒ­åº¦0.95)&#x27;</span>]<br><br>        <span class="hljs-comment"># æŒ‰åˆ†æ•°æ’åº</span><br>        sorted_indices = np.argsort(scores.flatten())[::-<span class="hljs-number">1</span>]<br>        <span class="hljs-keyword">for</span> rank, idx <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(sorted_indices, <span class="hljs-number">1</span>):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;rank&#125;</span>. ç‰©å“<span class="hljs-subst">&#123;idx + <span class="hljs-number">1</span>&#125;</span> - <span class="hljs-subst">&#123;items_info[idx]&#125;</span> - åŒ¹é…åˆ†æ•°: <span class="hljs-subst">&#123;scores[idx][<span class="hljs-number">0</span>]:<span class="hljs-number">.4</span>f&#125;</span>&quot;</span>)<br><br>        <span class="hljs-keyword">return</span> scores<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-string">&quot;&quot;&quot;ä¸»å‡½æ•°&quot;&quot;&quot;</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;=&quot;</span> * <span class="hljs-number">60</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;åŒå¡”æ¨¡å‹ï¼ˆTwo-Tower Modelï¼‰å®ç°æ¼”ç¤º&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æ¥æºï¼šhttps://blog.csdn.net/goTsHgo/article/details/144259481&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;=&quot;</span> * <span class="hljs-number">60</span>)<br><br>    <span class="hljs-comment"># åˆ›å»ºæ¨¡å‹å®ä¾‹</span><br>    model = TwoTowerModel(user_feature_dim=<span class="hljs-number">3</span>, item_feature_dim=<span class="hljs-number">2</span>, embedding_dim=<span class="hljs-number">8</span>)<br><br>    <span class="hljs-comment"># æ„å»ºæ¨¡å‹</span><br>    model.build_model()<br><br>    <span class="hljs-comment"># æ‰“å°æ¨¡å‹ç»“æ„</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\næ¨¡å‹ç»“æ„ï¼š&quot;</span>)<br>    model.model.summary()<br><br>    <span class="hljs-comment"># è®­ç»ƒæ¨¡å‹</span><br>    history = model.train_model(epochs=<span class="hljs-number">50</span>)<br><br>    <span class="hljs-comment"># å¯è§†åŒ–è®­ç»ƒè¿‡ç¨‹</span><br>    model.visualize_training(history)<br><br>    <span class="hljs-comment"># æ¼”ç¤ºæ¨èåŠŸèƒ½</span><br>    model.demonstrate_recommendation()<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n&quot;</span> + <span class="hljs-string">&quot;=&quot;</span> * <span class="hljs-number">60</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;åŒå¡”æ¨¡å‹æ¼”ç¤ºå®Œæˆï¼&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;=&quot;</span> * <span class="hljs-number">60</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure>
                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" class="category-chain-item">æ·±åº¦å­¦ä¹ </a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E6%8E%A8%E8%8D%90%E7%AE%97%E6%B3%95/" class="print-no-link">#æ¨èç®—æ³•</a>
      
        <a href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" class="print-no-link">#æ·±åº¦å­¦ä¹ </a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>åŒå¡”æ¨¡å‹</div>
      <div>http://example.com/2025/10/24/åŒå¡”æ¨¡å‹/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>WZN</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2025å¹´10æœˆ24æ—¥</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>è®¸å¯åè®®</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/10/31/torch-rechub%E9%A1%B9%E7%9B%AE/" title="torch-rechub">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">torch-rechub</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/10/13/Word2Vec/" title="Word2Vec">
                        <span class="hidden-mobile">Word2Vec</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>ç›®å½•</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>
